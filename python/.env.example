# Archon Backend Environment Variables
# Copy this file to .env and fill in your values

# ============================================================================
# REQUIRED - Database Configuration
# ============================================================================

# Supabase Configuration
# Get these from your Supabase project settings
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-key-here

# IMPORTANT: Use the "service_role" key (not anon key)
# The service_role key bypasses Row Level Security (RLS) which is required
# for server-side operations

# ============================================================================
# SECURITY - CORS Configuration (CRITICAL)
# ============================================================================

# Allowed origins for CORS (comma-separated list)
# NEVER use "*" with credentials enabled - this is a security vulnerability!
#
# Development (default if not set):
ALLOWED_ORIGINS=http://localhost:3737,http://localhost:3000,http://127.0.0.1:3737
#
# Production (example):
# ALLOWED_ORIGINS=https://archon.yourdomain.com,https://www.archon.yourdomain.com
#
# Important: Only add origins you trust and control

# ============================================================================
# OPTIONAL - AI/LLM Configuration
# ============================================================================

# OpenAI API Key (for embeddings and GPT models)
OPENAI_API_KEY=sk-your-openai-key-here

# Anthropic Claude API Key (for Claude models)
ANTHROPIC_API_KEY=sk-ant-your-claude-key-here

# Google AI API Key (for Gemini models)
GOOGLE_API_KEY=your-google-ai-key-here

# ============================================================================
# OPTIONAL - RAG Configuration
# ============================================================================

# Enable hybrid search (vector + full-text)
# Improves recall by ~30%
USE_HYBRID_SEARCH=false

# Enable reranking with CrossEncoder
# Improves precision by ~40% but adds ~150ms latency
USE_RERANKING=false

# Reranking model (if USE_RERANKING=true)
RERANKING_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2

# Enable agentic RAG for code example extraction
USE_AGENTIC_RAG=true

# ============================================================================
# OPTIONAL - Observability
# ============================================================================

# Sentry DSN for error tracking
# Get from https://sentry.io
SENTRY_DSN=https://your-sentry-dsn-here

# Logfire API Key for logging and tracing
# Get from https://logfire.dev
LOGFIRE_API_KEY=your-logfire-key-here

# Enable Logfire logging
LOGFIRE_ENABLED=true

# OpenTelemetry OTLP endpoint
# For self-hosted observability backends
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# Environment name (development, staging, production)
ENVIRONMENT=development

# ============================================================================
# OPTIONAL - Server Configuration
# ============================================================================

# Port for the API server (default: 8181)
ARCHON_SERVER_PORT=8181

# Port for the UI (default: 3737)
ARCHON_UI_PORT=3737

# Database connection pool configuration
DB_POOL_MIN_SIZE=5
DB_POOL_MAX_SIZE=20
DB_POOL_MAX_QUERIES=50000
DB_POOL_MAX_IDLE=300

# ============================================================================
# OPTIONAL - Feature Flags
# ============================================================================

# Enable projects feature (can also be toggled in UI Settings)
PROJECTS_ENABLED=true

# Enable code extraction from crawled pages
CODE_EXTRACTION_ENABLED=true

# ============================================================================
# OPTIONAL - Rate Limiting
# ============================================================================

# Default rate limit (requests per minute)
# Format: "number/time_unit" (e.g., "100/minute", "5/second")
DEFAULT_RATE_LIMIT=100/minute

# ============================================================================
# OPTIONAL - Crawling Configuration
# ============================================================================

# Maximum pages to crawl per source
MAX_PAGES_PER_CRAWL=100

# Crawl delay between requests (milliseconds)
CRAWL_DELAY_MS=1000

# User agent for web crawling
USER_AGENT=Archon/1.0 (+https://github.com/yourusername/archon)

# ============================================================================
# OPTIONAL - Encryption
# ============================================================================

# Encryption key for credentials
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your-fernet-key-here

# ============================================================================
# OPTIONAL - Testing
# ============================================================================

# Disable features during testing
TESTING=false

# ============================================================================
# Docker-Specific Configuration
# ============================================================================

# Set to true when running in Docker
DOCKER_ENV=false

# Docker host for service discovery
DOCKER_HOST=archon-server
